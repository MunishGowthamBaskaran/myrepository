YUI.add("shopping-navigation",function(a){a.namespace("Shopping");if(typeof a.Shopping.Navigations==="undefined"){a.Shopping.Navigations=[];}a.Shopping.Navigation=function(d){var u=arguments;var k,e,p;var v=u[1]?u[1]:{};v.navSelector=typeof v.navSelector!=="undefined"?v.navSelector:"#navigation";v.navEntriesSelector=typeof v.navEntriesSelector!=="undefined"?v.navEntriesSelector:".nav-stack[class^=nav-] > ul > li";v.navEntriesLinkSelector=typeof v.navEntriesLinkSelector!=="undefined"?v.navEntriesLinkSelector:".nav-stack[class^=nav-] > ul > li a";v.navSubSelector=typeof v.navSubSelector!=="undefined"?v.navSubSelector:".nav-sub";v.navSubWrapSelector=typeof v.navSubWrapSelector!=="undefined"?v.navSubWrapSelector:".nav-sub-wrap";v.navSubListSelector=typeof v.navSubListSelector!=="undefined"?v.navSubListSelector:"ul";v.navSubModuleSelector=typeof v.navSubModuleSelector!=="undefined"?v.navSubModuleSelector:".yom-mod";v.insertArrow=typeof v.insertArrow!=="undefined"?v.insertArrow:true;v.timeoutShow=typeof v.timeoutShow!=="undefined"?v.timeoutShow:200;v.timeoutHide=typeof v.timeoutHide!=="undefined"?v.timeoutHide:50;v.autoSetup=typeof v.autoSetup!=="undefined"?v.autoSetup:true;v.event=typeof v.event!=="undefined"?v.event:"contentready";v.viewportOffset=typeof v.viewportOffset!=="undefined"?v.viewportOffset:20;v.navSubGroupSelector=typeof v.navSubGroupSelector!=="undefined"?v.navSubGroupSelector:".nav-sub-group";v.navSubGroupTruncate=typeof v.navSubGroupTruncate!=="undefined"?v.navSubGroupTruncate:{criteria:"count","arguments":{count:5}};v.zIndex=typeof v.zIndex!=="undefined"?v.zIndex:"10000700";function i(){if(v.autoSetup===true){switch(v.event){case"available":d.on(v.event,function(w){j.setup();},v.navSelector);break;case"contentready":d.on(v.event,function(w){j.setup();},v.navSelector);break;case"domready":d.on(v.event,function(w){j.setup();});break;default:d.on(v.event,function(w){j.setup();});}}}function m(){var w=d.one("body");p=(w&&w.getAttribute("dir")&&w.getAttribute("dir")==="rtl")||(w.hasClass("yog-rtl"))?"rtl":"ltr";k=d.one(v.navSelector);if(k){k.navigation={};e=k.all(v.navEntriesSelector);if(!e.isEmpty()){e.each(function(y,x){y.navigation={};y.navigation.navSub=y.one(v.navSubSelector);b(y);});}s();}}function s(){if(k&&k.navigation){var z=function(A){var B=A.currentTarget;if(B.get("tagName")==="A"){B=B.get("parentNode");}if(typeof B.navigation==="undefined"){B.navigation={};}n(B);};var w=function(C){var D=C.currentTarget;if(D.get("tagName")==="A"){D=D.get("parentNode");}var A=C.relatedTarget;if(typeof D.navigation==="undefined"){D.navigation={};}var B=function(){c(D);};if(C.type==="blur"){if(typeof D.navigation.timeoutShow!=="undefined"){clearTimeout(D.navigation.timeoutShow);}}if(C.type==="mouseout"){if(A&&A.ancestor("#"+D._node.id)===null){B();}}};var x=function(G){var H=u=G.currentTarget;if(H.get("tagName")==="A"){H=H.get("parentNode");}if(typeof H.navigation==="undefined"){H.navigation={};}var E=function(){if(H.previous()&&H.previous().one(">a")){tn=H.previous().one(">a");if(tn){tn.focus();}c(H);}else{c(H);}};var F=function(){if(H.next()&&H.next().one(">a")){tn=H.next().one(">a");if(tn){tn.focus();}c(H);}else{c(H);}};var A=function(){if(p==="rtl"){F();}else{E();}};var C=function(){var I=function(){if(H.previous()&&H.previous().one(">a")){tn=H.previous().one(">a");if(tn){tn.focus();}c(H);}else{c(H);}};if(H.ancestor(v.navEntriesSelector)!==null&&H.ancestor(v.navSubGroupSelector)===null&&H.hasClass("first")){_n=H.ancestor(v.navEntriesSelector).one(">a");if(_n){_n.focus();}else{I();}}else{if(H.ancestor(v.navSubGroupSelector)!==null&&H.hasClass("first")){_n=H.ancestor(v.navSubGroupSelector).one(">a");if(_n){_n.focus();}else{I();}}else{if(H.previous()&&H.previous().hasClass(v.navSubGroupSelector.substring(1))){_n=H.previous().one(v.navSubSelector+" li.last>a");if(_n){_n.focus();}else{I();}}else{I();}}}};var D=function(){if(p==="rtl"){E();}else{F();}};var B=function(){var I=function(){if(H.next()&&H.next().one(">a")){tn=H.next().one(">a");if(tn){tn.focus();}c(H);}else{c(H);}};if(H.one(v.navSubWrapSelector)!==null){H=H.one(v.navSubWrapSelector+" li.first>a");H.focus();}else{if(H.ancestor(v.navEntriesSelector)!==null&&H.ancestor(v.navSubGroupSelector)===null&&H.hasClass("last")){H=H.ancestor(v.navEntriesSelector);I();}else{if(H.ancestor(v.navEntriesSelector)!==null&&H.ancestor(v.navSubGroupSelector)===null&&H.hasClass(v.navSubGroupSelector.substring(1))){_n=H.one(v.navSubSelector+" li.first>a");if(_n){_n.focus();}else{I();}}else{if(H.ancestor(v.navSubGroupSelector)!==null&&H.hasClass("last")){H=H.ancestor(v.navSubGroupSelector);I();}else{I();}}}}};switch(G.keyCode){case 37:G.halt();A();break;case 38:G.halt();C();break;case 39:G.halt();D();break;case 40:G.halt();B();break;case 9:if(H.ancestor(v.navEntriesSelector)===null&&G.shiftKey===true){c(H);}if(H.ancestor(v.navEntriesSelector)!==null&&H.hasClass("last")&&G.shiftKey===false){H=H.ancestor(v.navEntriesSelector);c(H);}break;case 27:if(H.ancestor(v.navEntriesSelector)!==null){H=H.ancestor(v.navEntriesSelector);c(H);}else{c(H);}if(H.one(">a")){H.one(">a").blur();}break;default:}};var y=function(A){t=A.target;if(t&&t.ancestor(v.navSelector)===null){h();}};k.navigation.evMouseOver=d.delegate("mouseover",z,k,v.navEntriesSelector);k.navigation.evMouseOut=d.delegate("mouseout",w,k,v.navEntriesSelector);k.navigation.evFocus=d.delegate("focus",z,k,v.navEntriesLinkSelector);k.navigation.evBlur=d.delegate("blur",w,k,v.navEntriesLinkSelector);k.navigation.evKey=d.delegate("keydown",x,k,v.navEntriesLinkSelector);k.navigation.evBodyClick=d.on("click",y,"body");}}function b(C){if(C.navigation&&C.navigation.navSub){var w=C.navigation.navSub;var z;var B=w.one(v.navSubListSelector);var y=w.one(v.navSubModuleSelector);if((B&&typeof B.all(">li")!=="undefined"&&!B.all(">li").isEmpty())||(y)){w.wrap('<div class="'+v.navSubWrapSelector.replace(".","")+'"></div>');z=C.navigation.navSubWrap=C.one(v.navSubWrapSelector);C.navigation.navSub=C.one(v.navSubSelector);z.setStyle("position","absolute");if(B){B.wrap('<div class="entries"></div>');}if(y){y.wrap('<div class="teaser"></div>');}C.navigation.state=0;g(C);o(C);q(C);l(C);if(C.navigation.navSubWrap&&!C.navigation.evNavSubWrap){var A=function(E){var D=E.relatedTarget;if(D&&D.ancestor("#"+C._node.id)===null){c(C);}};C.navigation.evNavSubWrap=C.navigation.navSubWrap.on("mouseout",A);}var x=function(){g(C);};C.navigation.evOrientationChange=d.on("orientationchange",function(D){x();});C.navigation.evWindowLoad=d.on("load",function(D){x();});}else{w.remove();}}else{return false;}}function g(y){if(y.navigation.navSubWrap){var x=y.navigation.navSubWrap;var w=y.get("region");x.setStyle("width",(w.width)+"px");if(d.UA.gecko>0){x.setStyle("top",(w.height+4)+"px");}else{x.setStyle("top",(w.height)+"px");}if(p==="rtl"){if(y.getComputedStyle("display")!=="table-cell"){x.setStyle("right","0");}}else{if(y.getComputedStyle("display")!=="table-cell"){x.setStyle("left","0");}}}}function q(C){if(C.navigation.navSub){var x=C.navigation.navSub;var A=C.get("region");var w=x.get("region");var z=C.get("viewportRegion");C.navigation.final_width=w.width;if(p==="rtl"){var B=A.right-C.navigation.final_width;if(B<v.viewportOffset){x.setStyle("left","0");x.setStyle("right","auto");}else{x.setStyle("left","auto");x.setStyle("right","0");}}else{var y=A.left+C.navigation.final_width;if(y>z.width-v.viewportOffset){x.setStyle("right","0");x.setStyle("left","auto");}else{x.setStyle("right","auto");x.setStyle("left","0");}}}}function o(y){if(y.navigation.navSubWrap&&v.insertArrow===true){var w=y.navigation.navSubWrap;navSubWrap_region=w.get("region");var x=w.create('<div class="arrow"><em></em></div>');x.setStyle("width",navSubWrap_region.width+"px");w.insert(x);}}function l(x){var w=typeof x.navigation.navSubGroups!=="undefined"?x.navigation.navSubGroups:x.all(v.navSubGroupSelector);if(!w.isEmpty()){w.each(function(y,z){y.navigation={};y.navigation.config=(y.getAttribute("data-navigation-group-truncation"))?d.JSON.parse(y.getAttribute("data-navigation-group-truncation").replace(/\'/g,'"')):v.navSubGroupTruncate;y.navigation.config.arguments.more=y.getAttribute("data-navigation-group-more")?y.getAttribute("data-navigation-group-more"):"See All ";y.navigation.navSubGroupLink=y.one(">a");y.navigation.navSubGroupList=y.one(v.navSubSelector+" "+v.navSubListSelector);y.navigation.navSubGroupListItems=y.all(v.navSubSelector+" "+v.navSubListSelector+">li");r(y);});}}function r(y){function w(){if(y.navigation.navSubGroupLink&&y.navigation.navSubGroupList&&y.navigation.navSubGroupListItems&&y.navigation.navSubGroupListItems.size()>y.navigation.config.arguments.count){y.navigation.navSubGroupListItems.each(function(z,A){if(A>y.navigation.config.arguments.count-1){z.remove();}});y.navigation.navSubGroupList.append('<li class="last"><a href="'+y.navigation.navSubGroupLink.get("href")+'"><span>'+y.navigation.config.arguments.more+"</span></a></li>");}}function x(){}switch(y.navigation.config.criteria){case"count":w();break;case"viewport":break;}}function h(){if(e){e.each(function(w,x){if(w.ancestor(v.navEntriesSelector)===null){c(w);}});}}function f(w){if(e){e.each(function(x,y){if(w.ancestor(v.navEntriesSelector)===null&&w!==x){c(x);}});}}function n(x){if(x.navigation.state===0){f(x);if(x.navigation&&x.navigation.navSub){x.navigation.state=1;if(typeof x.navigation.timeoutHide!=="undefined"){clearTimeout(x.navigation.timeoutHide);delete x.navigation.timeoutHide;}var w=function(){x.addClass("on");if(k&&k.getStyle("zIndex")!==v.zIndex){k.setStyle("zIndex",v.zIndex);}q(x);if(typeof x.navigation.timeoutShow!=="undefined"){clearTimeout(x.navigation.timeoutShow);delete x.navigation.timeoutShow;}};if(v.timeoutShow>0){if(typeof x.navigation.timeoutShow==="undefined"){x.navigation.timeoutShow=setTimeout(w,v.timeoutShow);}}else{w();}}}}function c(x){if(x.navigation.state===1){if(x.navigation&&x.navigation.navSub){x.navigation.state=0;if(typeof x.navigation.timeoutShow!=="undefined"){clearTimeout(x.navigation.timeoutShow);delete x.navigation.timeoutShow;}var w=function(){x.removeClass("on");if(k&&(k.getStyle("zIndex")!=="auto"||k.getStyle("zIndex")!=="0")){try{k.setStyle("zIndex","auto");}catch(y){k.setStyle("zIndex","0");}}if(typeof x.navigation.timeoutHide!=="undefined"){clearTimeout(x.navigation.timeoutHide);delete x.navigation.timeoutHide;}};if(v.timeoutHide>0){if(typeof x.navigation.timeoutHide==="undefined"){x.navigation.timeoutHide=setTimeout(w,v.timeoutHide);}}else{w();}}}}var j={setup:function(){m();}};i();return j;};},"1.0.0",{requires:["node","event-delegate","event-key","json"]});